#!/bin/bash

uid="$(id -u $1)"
__file="
catch syscall ptrace
commands 1
        set (\$eax) = $uid
        continue
end
b getuid
run
step
set \$eax = $uid
step
"

echo "$__file" > /tmp/exploit.gdb

gdb --batch --command=/tmp/exploit.gdb --args /bin/getflag
